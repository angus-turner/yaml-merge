#!/usr/bin/env node

'use strict';
const resolve = require('path').resolve;
const index = require('../index.js');
const apiConverter = require('api-spec-converter');
const fs = require('fs');


const files = process.argv
    .slice(2)
    .map((path) => resolve(path));

const convertedJson = apiConverter.convert({
    from: 'openapi_3',
    to: 'swagger_2',
    source: files[1],
});
const cleanedFile = index.cleanupOpenAPI(convertedJson);

const outputFile = index.yamlMerge(files[0],cleanedFile);

fs.writeFile('result.yaml', outputFile, function (err) {
    if (err) return console.log(err);
    console.log(`OutputFile ${outputFile}`);
});
